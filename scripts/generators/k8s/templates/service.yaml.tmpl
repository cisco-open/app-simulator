apiVersion: v1
kind: Service
metadata:
{%- if service_type == 'ext' %}
  name: {{ service_name }}-service-ext
{%- else %}
  name: {{ service_name }}
{%- endif %}
spec:
  selector:
    app: {{ service_name }}
    service: {{ service_name }}
  ports:
    - protocol: TCP
      targetPort: {{ service_port }}
{%- if service_type == 'ext' %}
      port: {{ service_ext_port }}
  type: LoadBalancer
{%- else %}
      port: 80
  type: ClusterIP
{%- endif %}
